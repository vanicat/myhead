% Copyright 2010 by RenÃ©e Ahrens, Olof Frahm, Jens Kluttig, Matthias Schulz, Stephan Schuster
%
% This file may be distributed and/or modified
%
% 1. under the LaTeX Project Public License and/or
% 2. under the GNU Public License.
%
% See the file doc/generic/pgf/licenses/LICENSE for more details.

\ProvidesFileRCS[v\pgfversion] $Header: /cvsroot/pgf/pgf/generic/pgf/graphdrawing/core/tikzlayer/tikzlibrarygraphdrawing.code.tex,v 1.3 2011/05/15 14:15:45 jannis-pohlmann Exp $

\usepgflibrary{graphdrawing}




%
% Setup graph drawing for tikz
% 

\tikzset{
  graph drawing scope/.style={
    % 
    % General stuff
    %
    /tikz/execute at begin scope={
      \pgfgdsetedgecallback{\pgfgdtikzedgecallback}
      \pgfgdbeginscope},
    /tikz/execute at end scope={\pgfgdendscope},
    % 
    % Setup for plain syntax
    % 
    /utils/exec=\pgfgdaddspecificationhook{\tikzset{edge macro=\tikz@gd@plain@edge@macro}},
    % 
    % Setup for the graphs syntax 
    %
    /tikz/--/.style={arrows=-},
    /tikz/graphs/new ->/.code n args={4}{\pgfgdedge{##1}{##2}{->}{/tikz,##3}{##4}},
    /tikz/graphs/new <-/.code n args={4}{\pgfgdedge{##1}{##2}{<-}{/tikz,##3}{##4}},
    /tikz/graphs/new --/.code n args={4}{\pgfgdedge{##1}{##2}{--}{/tikz,##3}{##4}},
    /tikz/graphs/new <->/.code n args={4}{\pgfgdedge{##1}{##2}{<->}{/tikz,##3}{##4}},
    /tikz/graphs/new -!-/.code n args={4}{\pgfgdedge{##1}{##2}{-!-}{/tikz,##3}{##4}},
    /tikz/graphs/placement/compute position/.code=,%
    % 
    % Setup for the tree syntax
    %
    /tikz/growth function=\relax,
    /tikz/edge from parent macro=\tikz@gd@edge@from@parent@macro
  },
  % Link in...
  /graph drawing/at begin scope/.forward to=/tikz/graph drawing scope
}

\pgfgdappendtoforwardinglist{/tikz/,/tikz/graphs/}

\def\pgfgdtikzedgecallback#1#2#3#4#5#6#7{%
  \draw 
    [to path={#7 -- (\tikztotarget) \tikztonodes}]
    [#3,#4,/graph drawing/.cd,#6]
     (#1\tikzparentanchor)
       to
       #5
     (#2\tikzchildanchor);%
}

\def\tikz@gd@edge@from@parent@macro#1#2{
  [/utils/exec=\pgfgdedge{\tikzparentnode}{\tikzchildnode}{--}{/tikz,#1}{#2}]
}

\def\tikz@gd@plain@edge@macro#1#2{
  \pgfgdedge{\tikztostart}{\tikztotarget}{--}{/tikz,#1}{#2}
}



% 
% Conversions: Convert coordinates into pairs of values surrounded by
% braces. 
%

\pgfgdset{
  conversions/coordinate/.code={%
    \tikz@scan@one@point\pgf@process#1%
    \pgfmathsetmacro{\tikz@gd@temp@x}{\pgf@x}
    \pgfmathsetmacro{\tikz@gd@temp@y}{\pgf@y}
    \edef\pgfgdresult{{\tikz@gd@temp@x}{\tikz@gd@temp@y}}
  }
}





\endinput
